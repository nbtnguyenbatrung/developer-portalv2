# OPEN BANKING v1.2 - GET STARTED

# 1. Giới thiệu chung

## 1.1. Đối tượng sử dụng

Tài liệu này được sử dụng bởi các nhà phát triển, chuyên gia kỹ thuật và phân tích nghiệp vụ nhằm hỗ trợ tích hợp thành công cho đối tác vào hệ thống Open Banking.

## 1.2. Phạm vi tài liệu

Tài liệu cung cấp cho bên tham gia bao gồm TPP, DP các thông tin về luồng giao dịch, bảo mật và mã hóa dữ liệu cũng như chi tiết về đặc tả API bao gồm thông tin đầu vào, đầu ra (Request / Response) cùng với bảng mã lỗi của hệ thống Open Banking.

## 1.3. Hỗ trợ kỹ thuật

Đối với bất cứ thông tin thắc mắc nào cần hỗ trợ, vui lòng liên hệ với bộ phận hỗ trợ hệ thống Napas.

## 1.4. Cách sử dụng tài liệu

Các API được mô tả trong tài liệu này được hiển thị dưới dạng bảng, gồm các phần chính sau:

**Toàn bộ API sẽ bao gồm các thuộc tính:**

* Tên trường sử dụng trong bản tin.
* Kiểu dữ liệu của trường thông tin.
* Độ dài tối đa của dữ liệu.
* Mô tả trường dữ liệu.
* Bắt buộc có tham số hoặc tùy chọn:
  * M: Trường bắt buộc phải có giá trị.
  * O: Trường không bắt buộc có giá trị.
  * C: Trường bắt buộc khi đáp ứng một số điều kiện.

# 2. Bảo mật và mã hóa dữ liệu

## 2.1. Kiểm soát truy cập và bảo mật

### 2.1.1. Ủy quyền OAuth2

![This is an alt text.](../images/ob_1.png 'This is a sample image.')

Trong hệ sinh thái Open Banking, mọi truy cập đều phụ thuộc vào cơ chế ủy quyền chặt chẽ. Khi một ứng dụng hoặc bên thứ ba muốn truy cập tài nguyên của người dùng trên Resource Server, họ phải trải qua quá trình xác thực và ủy quyền với Authorization Server thông qua giao thức OAuth 2.

Quá trình bắt đầu khi ứng dụng gửi yêu cầu ủy quyền, bao gồm các scope để truy cập vào API cần thiết. Nếu yêu cầu được chấp thuận, Authorization Server sẽ cấp phát một access token theo định dạng JWT chứa thông tin xác thực, thời gian hết hạn và các quyền truy cập đã yêu cầu.

Khi ứng dụng sử dụng access token để truy cập Resource Server, mã này sẽ được xác thực để đảm bảo tính hợp lệ và các quyền được cấp. Nếu mọi thứ đều chính xác, ứng dụng sẽ được phép truy cập tài nguyên yêu cầu. Việc sử dụng JWT không chỉ đảm bảo tính toàn vẹn mà còn nâng cao khả năng quản lý và giám sát truy cập vào hệ thống, đảm bảo an toàn cho dữ liệu người dùng

Ví dụ về scope: Nếu Endpoint cần sử dụng là: {domain}/ob/v1/accounts/balances & {domain}/ob/v1/accounts/transactions, ta sẽ dùng scope có giá trị sau (Ghép các giá trị scope lại và nối với nhau bằng một khoảng trắng):

<table><tbody><tr><td><p>ob.v1.accounts.balances ob.v1.accounts.transactions</p></td></tr></tbody></table>

### 2.1.2 Giao thức kết nối

Yêu cầu sử dụng giao thức tối thiểu TLS phiên bản 1.2 trở lên để đảm bảo tính bảo mật trong việc truyền tải dữ liệu giữa các bên. Bên cạnh đó, có thể sử dụng mTLS (Mutual TLS) để tăng cường bảo mật (không bắt buộc).

mTLS khác với TLS thông thường ở chỗ nó yêu cầu cả hai bên (máy khách và máy chủ) phải xác thực lẫn nhau bằng cách sử dụng chứng chỉ số. Điều này giúp ngăn chặn các cuộc tấn công giả mạo và bảo đảm rằng chỉ những bên được ủy quyền mới có thể thiết lập kết nối. Với mTLS, các thông tin nhạy cảm được bảo vệ hơn nữa, vì cả hai bên đều có trách nhiệm xác thực, tạo ra một lớp bảo mật bổ sung cho các giao dịch trong hệ sinh thái Open Banking.

![This is an alt text.](../images/ob_2.png 'This is a sample image.')

Cả hai bên (máy khách và máy chủ) cần phải tạo ra cặp khóa gồm public key và private key. Private key phải được giữ bí mật và chỉ được sử dụng để ký thông điệp hoặc xác thực giao dịch. Trong khi đó, public key có thể được chia sẻ công khai để cho phép bên còn lại xác thực chữ ký. Khi thiết lập kết nối mTLS, máy chủ sẽ yêu cầu máy khách cung cấp chứng chỉ số, trong đó chứa public key của máy khách.

Máy chủ sẽ kiểm tra chứng chỉ này để xác minh tính hợp lệ và danh tính của máy khách. Ngược lại, máy khách cũng yêu cầu chứng chỉ của máy chủ để đảm bảo rằng nó đang giao tiếp với đúng bên. Quá trình này giúp tạo ra một kết nối an toàn và đáng tin cậy, đảm bảo rằng cả hai bên đều được xác thực trước khi trao đổi dữ liệu nhạy cảm.

## 2.2. Phương pháp ký và mã hóa dữ liệu

### 2.2.1 Phương pháp ký dữ liệu

Hệ sinh thái Open Banking sử dụng JWS (JSON Web Signature) với thuật toán **PS256** và cặp khóa công khai / riêng tư có **độ dài 2048 bit** để ký dữ liệu. Điều này giúp đảm bảo rằng thông tin được ký là chính xác và không bị thay đổi trong quá trình truyền tải, tạo ra một phương pháp bảo mật hiệu quả cho việc trao đổi dữ liệu nhạy cảm.

![This is an alt text.](../images/ob_3.png 'This is a sample image.')

**Các bước ký dữ liệu:**

\+ Tạo header: chứa thông tin về thuật toán ký.

<table><tbody><tr><td><p>{ "alg": "PS256" }</p></td></tr></tbody></table>

\+ Base64Url Encode Header: chuyển đổi header thành chuỗi JSON và mã hóa bằng Base64Url.

<table><tbody><tr><td><p>Kết quả: &lt;encodedHeader&gt;</p></td></tr></tbody></table>

\+ Chuẩn bị payload: dữ liệu cần truyền tải, ví dụ:

<table><tbody><tr><td><p>{ "sub": "1234567890", "name": "John Doe", "iat": 1516239022 }</p></td></tr></tbody></table>

\+ SHA256 Hash Payload: hash payload bằng thuật toán SHA256.

<table><tbody><tr><td><p>Kết quả: &lt;hashedPayload&gt;</p></td></tr></tbody></table>

\+ Base64Url Encode Hashed Payload: mã hóa hashed payload bằng Base64Url.

<table><tbody><tr><td><p>Kết quả: &lt;encodedHashedPayload&gt;</p></td></tr></tbody></table>

\+ Nối chuỗi: Kết hợp header và hashed payload đã mã hóa.

<table><tbody><tr><td><p>Kết quả: &lt;encodedHeader&gt;.&lt;encodedHashedPayload&gt;</p></td></tr></tbody></table>

\+ Ký dữ liệu: Sử dụng private key với thuật toán PS256 để ký chuỗi đã nối.

<table><tbody><tr><td><p>Kết quả: signature</p></td></tr></tbody></table>

\+ Base64Url Encode Chữ Ký: Mã hóa chữ ký bằng Base64Url.

<table><tbody><tr><td><p>Kết quả: &lt;encodedSignature&gt;</p></td></tr></tbody></table>

\+ Kết hợp các phần để tạo JWS và đính kèm vào trường JWS-Signature trong header của bản tin request.

<table><tbody><tr><td><p>JWS-Signature: &lt;encodedHeader&gt;.&lt;encodedHashedPayload&gt;.&lt;encodedSignature&gt;</p></td></tr></tbody></table>

### 2.2.2. Phương pháp mã hóa và giải mã dữ liệu

Để mã hóa dữ liệu nhạy cảm, hệ sinh thái Open Banking sử dụng **thuật toán AES** (một thuật toán mã hóa đối xứng) **kết hợp với RSA** (một thuật toán mã hóa bất đối xứng), với các thông số:

\+ AES: sử dụng khóa có **độ dài 256 bit**, **chế độ AES-256-GCM**. Mỗi lần thực hiện mã hóa một giao dịch, một khóa AES mới sẽ được sinh ra ngẫu nhiên. Việc này đảm bảo rằng ngay cả khi dữ liệu giống nhau được mã hóa nhiều lần, kết quả sẽ hoàn toàn khác nhau.

\+ RSA: sử dụng khóa có **độ dài 2048 bit** với lược đồ **RSAES-OAEP** để mã hóa khóa AES. RSAES-OAEP cung cấp bảo mật cao hơn so với các lược đồ mã hóa RSA truyền thống nhờ sử dụng padding tối ưu và hàm băm. Khi mã hóa khóa AES, dữ liệu sẽ được thêm vào padding ngẫu nhiên trước khi được mã hóa bằng khóa RSA công khai, giúp bảo vệ thông điệp khỏi các cuộc tấn công dựa trên cấu trúc dữ liệu.

![This is an alt text.](../images/ob_4.png 'This is a sample image.')

Lưu ý: Có thể mã hóa cả bản tin hoặc mã hóa từng trường phụ thuộc vào yêu cầu thực tế.

Ví dụ dữ liệu đầu vào:

<table><tbody><tr><td><p>{ "name": "Nguyen Van A", "accountNo": "so-tai-khoan-can-ma-hoa" }</p></td></tr></tbody></table>

Dữ liệu sau khi mã hóa:

<table><tbody><tr><td><p>{</p><p>"name": "Nguyen Van A",</p><p>"accountNo": {</p><p>"cipherText": "&lt;mã hóa accountNo&gt;",</p><p>"iv": "&lt;giá trị IV&gt;",</p><p>"tag": "&lt;giá trị tag&gt;",</p><p>"encryptedKey": "&lt;mã hóa khóa AES&gt;"</p><p>}</p><p>}</p></td></tr></tbody></table>

Giải thích các thành phần:

\+ **cipherText**: Dữ liệu (accountNo) đã được mã hóa, đây là phần dữ liệu không thể đọc được nếu không có khóa giải mã AES.

\+ **iv** (Initialization Vector): Giá trị ngẫu nhiên dùng trong quá trình mã hóa, iv đảm bảo rằng mã hóa dữ liệu giống nhau sẽ cho ra kết quả khác nhau, giúp tăng tính bảo mật.

\+ **tag**: Giá trị được sinh ra bởi chế độ GCM để kiểm tra tính toàn vẹn của dữ liệu. Khi giải mã, tag sẽ được sử dụng để xác nhận rằng dữ liệu chưa bị thay đổi.

\+ **encryptedKey**: Khóa AES đã được mã hóa bằng RSA, chỉ người sở hữu khóa riêng RSA mới có thể giải mã để lấy lại khóa AES.

Kết quả cuối cùng:

<table><tbody><tr><td><p>{</p><p>"name": "Nguyen Van A",</p><p>"accountNo": <strong>base64-url-encode</strong>({</p><p>"cipherText": "&lt;mã hóa accountNo&gt;",</p><p>"iv": "&lt;giá trị IV&gt;",</p><p>"tag": "&lt;giá trị tag&gt;",</p><p>"encryptedKey": "&lt;mã hóa khóa AES&gt;"</p><p>})</p><p>}</p></td></tr></tbody></table>

### 2.2.3. Quản lý cặp khóa

Trong hệ sinh thái Open Banking, các đối tác được yêu cầu chuẩn bị hai cặp khóa riêng (private key) và khóa công khai (public key) với độ dài 2048 bit.

\+ Cặp khóa đầu tiên sẽ được sử dụng cho QWAC để thực hiện xác thực MTLS, đảm bảo kết nối an toàn giữa các bên (**không bắt buộc**).

\+ Cặp khóa thứ hai sẽ được sử dụng cho QSEAL nhằm thực hiện các thao tác ký, mã hóa và giải mã dữ liệu (**bắt buộc**).

Mặc định, thời gian sử dụng chứng chỉ (cert) là 5 năm. Trong trường hợp đối tác muốn điều chỉnh thời gian này, vui lòng trao đổi thêm để thống nhất phương án.

Việc sử dụng các cặp khóa riêng biệt này không chỉ giúp tăng cường bảo mật mà còn đảm bảo tính toàn vẹn và bảo mật của dữ liệu trong suốt quá trình giao dịch. Các đối tác cần đảm bảo quản lý và bảo vệ các cặp khóa này một cách nghiêm ngặt để tránh rủi ro bị lộ thông tin nhạy cảm.

# 3. Mô hình kết nối và luồng giao dịch

## 3.1. Mô hình kết nối

Hệ sinh thái Open Banking cung cấp một phương thức an toàn và đơn giản cho các DP và TPP trao đổi các dịch vụ dựa trên dữ liệu được chia sẻ. Các DP và TPP có thể chia sẻ nhiều loại dữ liệu tài chính khác nhau, như thông tin chi tiết về tài khoản và thông tin giao dịch, nhằm mang đến cho khách hàng (Chủ tài khoản/người dùng cuối) các giải pháp sáng tạo trong nhiều lĩnh vực khác nhau.

![This is an alt text.](../images/ob_5.png 'This is a sample image.')

## 3.2. Các luồng giao dịch

### 3.2.1. Luồng chấp thuận

![This is an alt text.](../images/ob_6.png 'This is a sample image.')

### 3.2.2. Luồng truy vấn thông tin tài khoản (AIS)

![This is an alt text.](../images/ob_7.png 'This is a sample image.')

### 3.2.3. Luồng khởi tạo thanh toán (PIS)

![This is an alt text.](../images/ob_8.png 'This is a sample image.')

### 3.2.4. Luồng thu hồi chấp thuận từ TPP

![This is an alt text.](../images/ob_9.png 'This is a sample image.')

# 4. Thiết kế giao diện API

## 4.1. Định dạng chung của Header

Dưới đây là bảng liệt kê các tham số phổ biến trong Header của request và response. Các tham số bổ sung thêm hoặc thay đổi (nếu có) sẽ được mô tả chi tiết trong từng API cụ thể.

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Header Request</strong></p></td></tr><tr><td><p>Content-Type</p></td><td><p>M</p></td><td><p>String [16]</p></td><td><p>Mặc định “application/json”</p></td></tr><tr><td><p>Authorization</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Mã truy cập (access_token) theo tiêu chuẩn OAuth 2.0 với grant type client credentials.<br>Cấu trúc: <em>Bearer access_token</em></p></td></tr><tr><td><p>Request-DateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày giờ thực hiện, định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>Request-ID</p></td><td><p>M</p></td><td><p>String [36]</p></td><td><p>Mã định danh duy nhất cho yêu cầu, thường ở định dạng UUID</p></td></tr><tr><td><p>PSU-IP-Address</p></td><td><p>O</p></td><td><p>String [50]</p></td><td><p>Địa chỉ IP của người dùng thực hiện yêu cầu API, giá trị ở dạng IPv4 hoặc IPv6 (Chỉ áp dụng cho giao diện API của OB).</p></td></tr><tr><td><p>PSU-User-Agent</p></td><td><p>O</p></td><td><p>String [255]</p></td><td><p>Xác định ứng dụng, hệ điều hành, nhà cung cấp phần mềm, và phiên bản của người dùng đang gửi yêu cầu.</p></td></tr><tr><td><p>Provider-ID</p></td><td><p>C</p></td><td><p>String [6]</p></td><td><p>Mã định danh của DP: mã do NHNN cấp cho các tổ chức tín dụng.</p><p>Bắt buộc khi thực hiện các API về khởi tạo xác thực và uỷ quyền (consent), AIS, PIS.</p></td></tr><tr><td><p>TPP-ID</p></td><td><p>C</p></td><td><p>String [13]</p></td><td><p>Mã số thuế của TPP.</p><p>Bắt buộc khi thực hiện các API về consent, AIS, PIS.</p></td></tr><tr><td><p>TPP-NAME</p></td><td><p>C</p></td><td><p>String[24]</p></td><td><p>Tên đầy đủ của TPP được mã hóa base64.</p><p>Bắt buộc khi thực hiện các API về consent, AIS, PIS (Chỉ áp dụng cho giao diện API của DP).</p></td></tr><tr><td><p>Application</p></td><td><p>C</p></td><td><p>String[24]</p></td><td><p>Mã ID của ứng dụng.</p><p>Bắt buộc khi thực hiện các API về consent, AIS, PIS (Chỉ áp dụng cho giao diện API của OB).</p></td></tr><tr><td><p>JWS-Signature</p></td><td><p>C</p></td><td><p>String [2000]</p></td><td><p>Chữ ký số của JWS theo RFC 7515.</p><p>Bắt buộc khi có dữ liệu trong payload.</p><p>Tham khảo tại mục 2.2.1. Phương pháp ký dữ liệu.</p></td></tr><tr><td><p>Host</p></td><td><p>O</p></td><td><p>String [100]</p></td><td><p>Xác định tên miền của máy chủ mà yêu cầu đang được gửi tới.</p></td></tr><tr><td><p><strong>Header Response</strong></p></td></tr><tr><td><p>Content-Type</p></td><td><p>M</p></td><td><p>String [16]</p></td><td><p>Mặc định “application/json”</p></td></tr><tr><td><p>Request-ID</p></td><td><p>M</p></td><td><p>String [36]</p></td><td><p>Giá trị được lấy từ header request</p></td></tr><tr><td><p>JWS-Signature</p></td><td><p>C</p></td><td><p>String [2000]</p></td><td><p>Chữ ký số của JWS theo RFC 7515.</p><p>Bắt buộc khi có dữ liệu trong payload.</p><p>Tham khảo tại mục 2.2.1. Phương pháp ký dữ liệu.</p></td></tr></tbody></table>

## 4.2. Giao diện API của Open Banking (OB)

### 4.2.1. API lấy mã truy cập

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/v1/oauth2/token</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>Cho phép các bên tham gia lấy thông tin mã truy cập (access_token) trên OB</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Header Request</strong></p></td></tr><tr><td><p>Content-Type</p></td><td><p>M</p></td><td><p>String [35]</p></td><td><p>application/x-www-form-urlencoded</p></td></tr><tr><td><p>Authorization</p></td><td><p>M</p></td><td><p>String [200]</p></td><td><p>Basic Base64 (client_id:client_secret): Định danh kỹ thuật được TPP, DP đăng ký trên developer portal của OB.</p></td></tr><tr><td><p><strong>Header Response</strong></p></td></tr><tr><td><p>Content-Type</p></td><td><p>M</p></td><td><p>String [16]</p></td><td><p>Mặc định “application/json”</p></td></tr></tbody></table>

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>grant_type</p></td><td><p>M</p></td><td><p>String [18]</p></td><td><p>Mặc định “client_credentials”</p></td></tr><tr><td><p>scope</p></td><td><p>M</p></td><td><p>String [500]</p></td><td><p>Phạm vi, quyền hạn của mã truy cập được phép thực hiện.</p><p>Tham khảo thêm tại mục 2.1.1. Ủy quyền OAuth2.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.1. Bảng mã lỗi API lấy mã truy cập.</p></td></tr><tr><td><p>access_token</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Mã truy cập.</p></td></tr><tr><td><p>token_type</p></td><td><p>M</p></td><td><p>String [10]</p></td><td><p>Mặc định “Bearer”</p></td></tr><tr><td><p>expires_in</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Giá trị hiệu lực của mã truy cập, tính bằng giây.</p><p>Độ dài tối đa của trường là 6 chữ số.</p></td></tr><tr><td><p>scope</p></td><td><p>M</p></td><td><p>String [500]</p></td><td><p>Phạm vi của mã truy cập được lấy giá trị từ yêu cầu của TPP.</p></td></tr></tbody></table>

### 4.2.2. API lấy danh sách DP

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/v1/providers</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>GET</p></td></tr><tr><td><p>Mô tả</p></td><td><p>Cung cấp thông tin danh sách DP trên OB với trạng thái mặc định “AUTHORIZED”.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong>: N/A</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.2. Bảng mã lỗi API lấy danh sách DP.</p></td></tr><tr><td><p>providers</p></td><td><p>M</p></td><td><p>Array of Object</p></td><td><p>Danh sách các DP hiệu lực trên OB.</p></td></tr><tr><td><p>providers.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã do NHNN cấp cho các tổ chức tín dụng.</p></td></tr><tr><td><p>providers.fullName</p></td><td><p>M</p></td><td><p>String [255]</p></td><td><p>Tên của DP như đã được cung cấp trong mẫu đơn đăng ký với OB.</p></td></tr><tr><td><p>providers.shortName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên rút gọn của DP.</p></td></tr><tr><td><p>providers.status</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Mặc định “AUTHORIZED”.</p></td></tr><tr><td><p>providers.url</p></td><td><p>O</p></td><td><p>String [100]</p></td><td><p>Link website của DP.</p></td></tr><tr><td><p>providers.logo</p></td><td><p>M</p></td><td><p>String [255]</p></td><td><p>Đường dẫn logo của DP.</p></td></tr><tr><td><p>providers.address</p></td><td><p>M</p></td><td><p>String&nbsp;[255]</p></td><td><p>Địa chỉ của DP như trên đăng ký kinh doanh.</p></td></tr><tr><td><p>providers.phone</p></td><td><p>M</p></td><td><p>String&nbsp;[20]</p></td><td><p>Số điện thoại của DP (đầu mối chịu trách nhiệm đăng ký đơn onboarding với OB).</p></td></tr><tr><td><p>providers.email</p></td><td><p>M</p></td><td><p>String&nbsp;[50]</p></td><td><p>Địa chỉ email của DP (đầu mối chịu trách nhiệm đăng ký đơn onboarding với OB).</p></td></tr><tr><td><p>providers.authUrl</p></td><td><p>C</p></td><td><p>String [255]</p></td><td><p>Đường dẫn điều hướng xác thực người dùng.</p><p>Bắt buộc trong trường hợp sử dụng xác thực người dùng theo luồng Redirect.</p></td></tr><tr><td><p>providers.period</p></td><td><p>M</p></td><td><p>Array of Number</p></td><td><p>Thời gian hiệu lực của luồng chấp thuận người dùng khi sử dụng dịch vụ AIS.</p><p>Ví dụ: [30, 60, 90, 120, 180].</p></td></tr><tr><td><p>providers.activationDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày giờ gia nhập OB, định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>providers.exclusions</p></td><td><p>O</p></td><td><p>Array of Object</p></td><td><p>Danh sách TPP bị DP từ chối gọi API.</p></td></tr><tr><td><p>providers.exclusions.taxCode</p></td><td><p>O</p></td><td><p>String [13]</p></td><td><p>Mã số thuế của TPP.</p></td></tr><tr><td><p>providers.exclusions.name</p></td><td><p>O</p></td><td><p>String [50]</p></td><td><p>Tên TPP bị từ chối.</p></td></tr><tr><td><p>providers.exclusions.reason</p></td><td><p>O</p></td><td><p>String [255]</p></td><td><p>Lý do bị từ chối.</p></td></tr></tbody></table>

### 4.2.3. Nhóm API yêu cầu xác thực và chấp thuận

#### 4.2.3.1. API khởi tạo yêu cầu xác thực và chấp thuận

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/decoupled/v1/auth-request</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu khởi tạo xác thực và chấp thuận tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><a id="_Hlk179529742"></a><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>permissions</p></td><td><p>M</p></td><td><p>String [300]</p></td><td><p>Phạm vi của phiên xác thực và chấp thuận (được dùng tương tự như tham số scope):</p><ul><li>accounts: dịch vụ lấy danh sách tài khoản.</li><li>account_detail: dịch vụ lấy chi tiết tài khoản.</li><li>balances: dịch vụ tra cứu số dư tài khoản.</li><li>transactions: dịch vụ truy vấn lịch sử giao dịch.</li></ul></td></tr><tr><td><p>period</p></td><td><p>C</p></td><td><p>Number</p></td><td><p>Thời gian hiệu lực của phiên chấp thuận.</p><p>Áp dụng cho luồng AIS với đơn vị tính là ngày và không vượt quá 180 ngày.</p><p>Độ dài tối đa của trường là 3 chữ số.</p></td></tr><tr><td><p>psuType</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Loại phương thức xác định Chủ tài khoản bao gồm 1 trong các lựa chọn sau:</p><ul><li>phoneNumber: số điện thoại.</li><li>accountNo: số tài khoản.</li><li>citizenId: căn cước công dân.</li><li>taxCode: mã số thuế.</li></ul></td></tr><tr><td><p>psuId</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin định danh của Chủ tài khoản tương ứng với psuType đã lựa chọn.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AWAITING_AUTH: Đã gửi yêu cầu thành công và đang chờ xác nhận.</p></td></tr><tr><td><p>obTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của OB. Giá trị được OB khởi tạo và trả về cho TPP.</p></td></tr></tbody></table>

#### 4.2.3.2. API lấy thông tin trạng thái xác thực và chấp thuận

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/decoupled/v1/auth-status/{obTransactionId}</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>GET</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu lấy thông tin trạng thái xác thực và chấp thuận.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><a id="_Hlk179556554"></a><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Path variable</strong></p></td></tr><tr><td><p>obTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của OB.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AWAITING_AUTH: Đã gửi yêu cầu thành công và đang chờ xác nhận.</p><p>+ AUTHORIZED: Đã xác thực và uỷ quyền thành công.</p><p>+ SCA_TIMEOUT: Quá thời gian chờ xác thực và chấp thuận từ Chủ tài khoản trên máy chủ xác thực của DP.</p><p>+ REJECT: Chủ tài khoản từ chối yêu cầu.</p><p>+ REVOKE: Chủ tài khoản hoặc DP thu hồi chấp thuận.</p></td></tr><tr><td><p>consentId</p></td><td><p>C</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p></td></tr><tr><td><p>expiredTime</p></td><td><p>C</p></td><td><p>String [20]</p></td><td><p>Thời gian hết hạn hiệu lực của phiên chấp thuận.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED, định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>accounts</p></td><td><p>C</p></td><td><p>String [5000]</p></td><td><p>Danh sách tài khoản đã được chủ tài khoản uỷ quyền. Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED, áp dụng cho luồng AIS.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Sau khi giải mã, các trường thông tin sẽ được bao bọc trong một mảng các đối tượng như bên dưới.</p></td></tr><tr><td><p>accounts.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p></td></tr><tr><td><p>accounts.accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên khách hàng.</p></td></tr><tr><td><p>orderId</p></td><td><p>C</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, áp dụng cho luồng PIS.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>C</p></td><td><p>String [4]</p></td><td><p>Trạng thái của lệnh thanh toán, áp dụng cho luồng PIS.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p><p>Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr></tbody></table>

#### 4.2.3.3. API thu hồi xác thực và chấp thuận

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/decoupled/v1/auth-revoke</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu thu hồi việc xác thực và chấp thuận của người dùng.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>consentId</p></td><td><p>M</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận.</p></td></tr><tr><td><p>message</p></td><td><p>M</p></td><td><p>String [49]</p></td><td><p>Authentication and consent revocation successful</p></td></tr></tbody></table>

#### 4.2.3.4. API cập nhật thông tin chấp thuận

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/decoupled/v1/update-consent</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>DP gửi yêu cầu cập nhật trạng thái chấp thuận người dùng tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP. Giá trị được DP khởi tạo và trả về cho OB.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AUTHORIZED: Đã xác thực và uỷ quyền thành công.</p><p>+ SCA_TIMEOUT: Quá thời gian chờ xác thực và chấp thuận từ Chủ tài khoản trên máy chủ xác thực của DP.</p><p>+ REJECT: Chủ tài khoản từ chối yêu cầu.</p><p>+ REVOKE: Chủ tài khoản hoặc DP thu hồi chấp thuận.</p></td></tr><tr><td><p>expiredTime</p></td><td><p>C</p></td><td><p>String [20]</p></td><td><p>Thời gian hết hạn hiệu lực của phiên chấp thuận.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED, định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>accounts</p></td><td><p>C</p></td><td><p>String [5000]</p></td><td><p>Danh sách tài khoản đã được chủ tài khoản uỷ quyền. Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED, áp dụng cho luồng AIS.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Sau khi giải mã, các trường thông tin sẽ được bao bọc trong một mảng các đối tượng như bên dưới.</p></td></tr><tr><td><p>accounts.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p></td></tr><tr><td><p>accounts.accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên khách hàng.</p></td></tr><tr><td><p>orderId</p></td><td><p>C</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, áp dụng cho luồng PIS.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>C</p></td><td><p>String [4]</p></td><td><p>Trạng thái của lệnh thanh toán, áp dụng cho luồng PIS.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p><p>Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận.</p></td></tr><tr><td><p>message</p></td><td><p>M</p></td><td><p>String [25]</p></td><td><p>Update consent successful</p></td></tr></tbody></table>

### 4.2.4. Nhóm API truy vấn thông tin tài khoản

#### 4.2.4.1. API lấy danh sách tài khoản

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/ais/v1/accounts</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu truy vấn danh sách các tài khoản của chủ tài khoản tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>consentId</p></td><td><p>M</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>accounts</p></td><td><p>M</p></td><td><p>String [8000]</p></td><td><p>Danh sách các tài khoản của chủ tài khoản.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Sau khi giải mã, các trường thông tin sẽ được bao bọc trong một mảng các đối tượng như bên dưới.</p></td></tr><tr><td><p>accounts.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p></td></tr><tr><td><p>accounts.accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên tài khoản của khách hàng.</p></td></tr><tr><td><p>accounts.type</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tài khoản (ISO 20022 - Cash Account Type Code)</p><p>Ví dụ:</p><p>TRAN: Tài khoản giao dịch, SVGS: tài khoản tiết kiệm, LOAN: tài khoản vay,</p><p>CARD: tài khản thanh toán bằng thẻ tín dụng…</p></td></tr><tr><td><p>accounts.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD</p></td></tr><tr><td><p>accounts.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP do Ngân hàng nhà nước cung cấp.</p></td></tr><tr><td><p>accounts.status</p></td><td><p>M</p></td><td><p>String [10]</p></td><td><p>Trạng thái của tài khoản</p></td></tr></tbody></table>

#### 4.2.4.2. API lấy chi tiết thông tin tài khoản

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/ais/v1/accounts/information</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu truy vấn chi tiết thông tin tài khoản của chủ tài khoản tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>consentId</p></td><td><p>M</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>data</p></td><td><p>M</p></td><td><p>String [3000]</p></td><td><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Mã hóa toàn bộ các tham số bên dưới và bao bọc trong 1 tham số data.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p></td></tr><tr><td><p>accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên tài khoản của khách hàng.</p></td></tr><tr><td><p>type</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tài khoản (ISO 20022 - Cash Account Type Code).</p><p>Ví dụ:</p><p>TRAN: Tài khoản giao dịch, SVGS: tài khoản tiết kiệm, LOAN: tài khoản vay, CARD: tài khoản thanh toán bằng thẻ tín dụng…</p></td></tr><tr><td><p>currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã 6 số do Ngân hàng nhà nước cung cấp.</p></td></tr><tr><td><p>bankName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên DP.</p></td></tr><tr><td><p>branchName</p></td><td><p>M</p></td><td><p>String [200]</p></td><td><p>Chi nhánh mở tài khoản.</p></td></tr><tr><td><p>customer</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về Chủ tài khoản.</p></td></tr><tr><td><p>customer.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên chủ tài khoản.</p></td></tr><tr><td><p>customer.phoneNumber</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Số điện thoại.</p></td></tr><tr><td><p>customer.email</p></td><td><p>O</p></td><td><p>String [50]</p></td><td><p>Email liên hệ.</p></td></tr><tr><td><p>customer.citizenId</p></td><td><p>C</p></td><td><p>String [20]</p></td><td><p>Căn cước công dân với khách hàng cá nhân.</p></td></tr><tr><td><p>customer.taxCode</p></td><td><p>C</p></td><td><p>String [13]</p></td><td><p>Mã số thuế đối với khách hàng doanh nghiệp.</p></td></tr><tr><td><p>customer.address</p></td><td><p>O</p></td><td><p>String [255]</p></td><td><p>Địa chỉ của chủ tài khoản.</p></td></tr><tr><td><p>openDate</p></td><td><p>O</p></td><td><p>String [20]</p></td><td><p>Ngày tạo tài khoản.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>lastTransactionDate</p></td><td><p>O</p></td><td><p>String [20]</p></td><td><p>Ngày giao dịch gần nhất.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>status</p></td><td><p>M</p></td><td><p>String [10]</p></td><td><p>Trạng thái của tài khoản</p></td></tr></tbody></table>

#### 4.2.4.3. API tra cứu số dư

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/ais/v1/accounts/balances</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu truy vấn số dư của chủ tài khoản tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>consentId</p></td><td><p>M</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p>accountName</p></td><td><p>O</p></td><td><p>String [50]</p></td><td><p>Tên tài khoản của khách hàng.</p></td></tr><tr><td><p>type</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tài khoản (ISO 20022 - Cash Account Type Code).</p><p>Ví dụ:</p><p>TRAN: Tài khoản giao dịch, SVGS: tài khoản tiết kiệm, LOAN: tài khoản vay,</p><p>CARD: tài khản thanh toán bằng thẻ tín dụng…</p></td></tr><tr><td><p>availableBalance</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư khả dụng.</p></td></tr><tr><td><p>availableBalance.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư khả dụng.</p></td></tr><tr><td><p>availableBalance.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số dư khả dụng trên tài khoản của khách hàng.</p></td></tr><tr><td><p>availableBalance.amount. currency</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>actualBalance</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư hiện tại.</p></td></tr><tr><td><p>actualBalance.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư hiện tại</p></td></tr><tr><td><p>actualBalance.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số dư hiện tại trên tài khoản của khách hàng.</p></td></tr><tr><td><p>actualBalance.amount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>holdBalance</p></td><td><p>O</p></td><td><p>Object</p></td><td><p>Thông tin về số tiền đang được tạm giữ.</p></td></tr><tr><td><p>holdBalance.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số tiền đang được tạm giữ.</p></td></tr><tr><td><p>holdBalance.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số tiền đang tạm giữ trên tài khoản của khách hàng.</p></td></tr><tr><td><p>holdBalance.amount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>creditDebitIndicator</p></td><td><p>O</p></td><td><p>String [4]</p></td><td><p>Theo tiêu chuẩn ISO 20022.</p><p>- CRDT (Credit) Số dư ghi có.</p><p>- DBIT (Debit) Số dư ghi nợ.</p></td></tr></tbody></table>

#### 4.2.4.4. API tra cứu lịch sử giao dịch

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/ais/v1/accounts/transactions</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu tra cứu lịch sử giao dịch của chủ tài khoản tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>consentId</p></td><td><p>M</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p>fromDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Thời gian giao dịch từ ngày.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>toDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Thời gian giao dịch đến ngày.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p><p>Khoảng thời gian tối đa là 30 ngày.</p></td></tr><tr><td><p>page</p></td><td><p>O</p></td><td><p>Number</p></td><td><p>Xác định số trang được yêu cầu. Các trang được đánh số từ 1. Nếu tham số không được chỉ định, API sẽ trả về trang đầu tiên (trang số 1).</p></td></tr><tr><td><p>size</p></td><td><p>O</p></td><td><p>Number</p></td><td><p>Xác định số lượng bản ghi trên 1 trang. Nếu tham số không được chỉ định, API sẽ trả về toàn bộ các bản ghi thoả mãn yêu cầu nhưng không quá 50 bản ghi / trang.</p><p>Trong trường hợp tham số được chỉ định, giá trị tối đa cho phép là 50.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>totalPages</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Tổng số trang.</p></td></tr><tr><td><p>currentPage</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Trang hiện tại.</p></td></tr><tr><td><p>nextPage</p></td><td><p>O</p></td><td><p>Number</p></td><td><p>Trang tiếp theo.</p></td></tr><tr><td><p>pageSize</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số bản ghi trên một trang.</p></td></tr><tr><td><p>totalCount</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Tống số bản ghi trên tất cả các trang.</p></td></tr><tr><td><p>transactions</p></td><td><p>C</p></td><td><p>String [500000]</p></td><td><p>Danh sách dữ liệu về lịch sử giao dịch.</p><p>Bắt buộc khi phát sinh giao dịch phù hợp với điều kiện tìm kiếm.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Sau khi giải mã, các trường thông tin sẽ được bao bọc trong một mảng các đối tượng như bên dưới.</p></td></tr><tr><td><p>transactions.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Số tiền giao dịch.</p></td></tr><tr><td><p>transactions.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số tiền giao dịch.</p></td></tr><tr><td><p>transactions.amount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>transactions.balances</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Số dư tài khoản.</p></td></tr><tr><td><p>transactions.balances.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số dư ở thời điểm giao dịch.</p></td></tr><tr><td><p>transactions.balances.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>transactions.creditDebitIndicator</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>- CRDT (Credit) Số dư ghi có.</p><p>- DBIT (Debit) Số dư ghi nợ.</p></td></tr><tr><td><p>transactions.reversalIndicator</p></td><td><p>O</p></td><td><p>boolean</p></td><td><p>Chỉ ra một giao dịch đã bị đảo ngược hoặc huỷ bỏ. Có thể bao gồm các giao dịch bị hoàn tiền, bị huỷ bỏ.</p></td></tr><tr><td><p>transactions.valueDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Thời gian giao dịch.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>transactions.bankTransactionCode</p></td><td><p>O</p></td><td><p>String [11]</p></td><td><p>Mã giao dịch để phân loại giao dịch khác nhau như thanh toán, rút tiền, nạp tiền, chuyển khoản.</p></td></tr><tr><td><p>transactions.references</p></td><td><p>M</p></td><td><p>String [36]</p></td><td><p>Mã định danh duy nhất cho mỗi giao dịch.</p></td></tr><tr><td><p>transactions.relatedParties</p></td><td><p>M</p></td><td><p>Object</p></td><td></td></tr><tr><td><p>transactions.relatedParties.debtor.name</p></td><td><p>M</p></td><td><p>String [140]</p></td><td><p>Tên của bên (người/công ty/tổ chức) thực hiện chuyển tiền, thanh toán sản phẩm dịch vụ…</p></td></tr><tr><td><p>transactions.relatedParties.debtor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của người chuyển tiền</p></td></tr><tr><td><p>transactions.relatedParties.debtor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của người chuyển.</p></td></tr><tr><td><p>transactions.relatedParties.creditor.name</p></td><td><p>M</p></td><td><p>String [140]</p></td><td><p>Tên của bên (người/công ty/ tổ chức) nhận được tiền hoặc thu tiền từ debtor.</p></td></tr><tr><td><p>transactions.relatedParties.creditor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của bên nhận tiền.</p></td></tr><tr><td><p>transactions.relatedParties.creditor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của bên nhận tiền.</p></td></tr><tr><td><p>transactions.additionalTransactionInformation</p></td><td><p>M</p></td><td><p>String [255]</p></td><td><p>Nội dung giao dịch.</p></td></tr></tbody></table>

### 4.2.5. Nhóm API khởi tạo thanh toán

#### 4.2.5.1. API khởi tạo thanh toán

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/pis/v1/payments</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu khởi tạo giao dịch thanh toán tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>data</p></td><td><p>M</p></td><td><p>String [5000]</p></td><td><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Mã hóa toàn bộ các tham số bên dưới và bao bọc trong 1 tham số data.</p></td></tr><tr><td><p>instructionIdentification</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch do TPP khởi tạo.</p><p>Khuyến nghị dùng định dạng: {TPP-ID}-{uuid}-{HHmmss}.</p></td></tr><tr><td><p>debtor</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán dịch vụ sản phầm, thanh toán lương…</p></td></tr><tr><td><p>debtor.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên của bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán sản phẩm dịch vụ, thanh toán lương…</p></td></tr><tr><td><p>debtor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của bên thực hiện thanh toán.</p></td></tr><tr><td><p>debtor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của bên thực hiện thanh toán. Mã 6 số do NHNN cấp cho các tổ chức tín dụng.</p></td></tr><tr><td><p>creditor.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên của bên (người/công ty/tổ chức) nhận được tiền hoặc thu tiền từ debtor.</p></td></tr><tr><td><p>creditor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của bên nhận tiền.</p></td></tr><tr><td><p>creditor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của bên nhận. Mã 6 số do NHNN cấp cho các tổ chức tín dụng.</p></td></tr><tr><td><p>remittanceInformation</p></td><td><p>M</p></td><td><p>String [255]</p></td><td><p>Nội dung giao dịch.</p></td></tr><tr><td><p>instructedAmount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p></p></td></tr><tr><td><p>instructedAmount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số tiền giao dịch.</p></td></tr><tr><td><p>instructedAmount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD…</p></td></tr><tr><td><p>requestedExecutionDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày thực hiện giao dịch.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>obTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của OB.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AWAITING_AUTH: Đã gửi yêu cầu thành công và đang chờ xác nhận.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Mặc định ở phần khởi tạo trạng thái:</p><p>PDNG: Giao dịch đang chờ xử lý</p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

#### 4.2.5.2. API hủy thanh toán giao dịch

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/pis/v1/payments/cancel</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu hủy giao dịch khởi tạo thanh toán tới hệ thống OB (với điều kiện giao dịch chưa được quyết toán). Thời gian hiệu lực của consentId sẽ tối đa 300s cho luồng PIS. Do đó, tuỳ thuộc vào nhu cầu sử dụng, TPP có thể cung cấp dịch vụ huỷ thanh toán cho Chủ tài khoản thông qua ứng dụng của TPP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>instructionIdentification</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch do TPP khởi tạo.</p><p>Khuyến nghị dùng định dạng: {TPP-ID}-{uuid}-{HHmmss}.</p></td></tr><tr><td><p>debtor</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán dịch vụ sản phầm, thanh toán lương…</p></td></tr><tr><td><p>debtor.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên của bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán sản phẩm dịch vụ, thanh toán lương…</p></td></tr><tr><td><p>debtor.accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Số tài khoản của bên thực hiện thanh toán.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

#### 4.2.5.3. API xác nhận thanh toán / hủy thanh toán

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/pis/v1/payments/submit</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu xác nhận thanh toán / hủy thanh toán tới hệ thống OB (với điều kiện API khởi tạo thanh toán đã thành công).</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>consentId</p></td><td><p>M</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>paymentId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: P{TPP-ID}HHmmss-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

#### 4.2.5.4. API truy vấn trạng thái thanh toán

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{domain}/ob/pis/v1/payments/status/{orderId}</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>GET</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu truy vấn trạng thái thanh toán tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Path variable</strong></p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống OB sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>paymentId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: P{TPP-ID}HHmmss-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

### 4.2.6. Các tham số khi gọi callback url

Hệ thống OB sẽ gửi kết quả chấp thuận tới callback url do TPP cung cấp, kèm theo tham số data trong body của request như sau:

<table><tbody><tr><td><p>Callback url: {tpp_callback}</p><p>HTTP Method: POST</p><p>Request body:</p><p>{</p><p>"data": {data}</p><p>}</p></td></tr></tbody></table>

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p>Giá trị data (tối đa 5000 ký tự) là 1 chuỗi JSON đầu vào chứa các tham số bên dưới. Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AWAITING_AUTH: Đã gửi yêu cầu thành công và đang chờ xác nhận.</p><p>+ AUTHORIZED: Đã xác thực và uỷ quyền thành công.</p><p>+ SCA_TIMEOUT: Quá thời gian chờ xác thực và chấp thuận từ Chủ tài khoản trên máy chủ xác thực của DP.</p><p>+ REJECT: Chủ tài khoản từ chối yêu cầu.</p><p>+ REVOKE: Chủ tài khoản hoặc DP thu hồi chấp thuận.</p></td></tr><tr><td><p>consentId</p></td><td><p>C</p></td><td><p>String [78]</p></td><td><p>Mã chấp thuận của người dùng do OB cung cấp cho TPP.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p></td></tr><tr><td><p>obTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của OB.</p></td></tr><tr><td><p>expiredTime</p></td><td><p>C</p></td><td><p>String [20]</p></td><td><p>Thời gian hết hạn hiệu lực của phiên chấp thuận.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED, định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>accounts</p></td><td><p>C</p></td><td><p>Object</p></td><td><p>Danh sách tài khoản đã được chủ tài khoản uỷ quyền. Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED, áp dụng cho luồng AIS.</p></td></tr><tr><td><p>accounts.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p></td></tr><tr><td><p>accounts.accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên khách hàng.</p></td></tr><tr><td><p>orderId</p></td><td><p>C</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, áp dụng cho luồng PIS.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>C</p></td><td><p>String [4]</p></td><td><p>Trạng thái của lệnh thanh toán, áp dụng cho luồng PIS.</p><p>Bắt buộc khi trạng thái uỷ quyền là AUTHORIZED.</p><p>Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr></tbody></table>

## 4.3. Giao diện API của DP

### 4.3.1. API lấy mã truy cập

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/v1/oauth2/token</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>Cho phép OB lấy thông tin mã truy cập (access_token) trên hệ thống của DP</p></td></tr></tbody></table>

Các thông tin khác tham chiếu tại mục 4.2.1. API lấy mã truy cập.

### 4.3.2. Nhóm API yêu cầu xác thực và chấp thuận

#### 4.3.2.1. API khởi tạo yêu cầu xác thực và chấp thuận

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/decoupled/v1/auth-request</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu khởi tạo xác thực và chấp thuận tới hệ thống DP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>permissions</p></td><td><p>M</p></td><td><p>String [300]</p></td><td><p>Phạm vi của phiên xác thực và chấp thuận (được dùng tương tự như tham số scope):</p><ul><li>accounts: dịch vụ lấy danh sách tài khoản.</li><li>account_detail: dịch vụ lấy chi tiết tài khoản.</li><li>balances: dịch vụ lấy số dư tài khoản.</li><li>transactions: dịch vụ truy vấn lịch sử giao dịch.</li></ul></td></tr><tr><td><p>period</p></td><td><p>C</p></td><td><p>Number</p></td><td><p>Thời gian hiệu lực của phiên chấp thuận.</p><p>Áp dụng cho luồng AIS với đơn vị tính là ngày và không vượt quá 180 ngày.</p><p>Độ dài tối đa của trường là 3 chữ số.</p></td></tr><tr><td><p>psuType</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Loại phương thức xác định Chủ tài khoản bao gồm 1 trong các lựa chọn sau:</p><ul><li>phoneNumber: số điện thoại.</li><li>accountNo: số tài khoản.</li><li>citizenId: căn cước công dân.</li><li>taxCode: mã số thuế.</li></ul></td></tr><tr><td><p>psuId</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin định danh của Chủ tài khoản tương ứng với psuType đã lựa chọn.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AWAITING_AUTH: Đã gửi yêu cầu thành công và đang chờ xác nhận.</p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP. Giá trị được DP khởi tạo và trả về cho OB.</p></td></tr></tbody></table>

#### 4.3.2.2. API thu hồi xác thực và chấp thuận

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/decoupled/v1/auth-revoke</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu thu hồi việc xác thực và chấp thuận của người dùng.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận.</p></td></tr><tr><td><p>message</p></td><td><p>M</p></td><td><p>String [49]</p></td><td><p>Authentication and consent revocation successful</p></td></tr></tbody></table>

### 4.3.3. Nhóm API truy vấn thông tin tài khoản

#### 4.3.3.1. API lấy danh sách tài khoản

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/ais/v1/accounts</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu truy vấn danh sách các tài khoản của chủ tài khoản tới hệ thống DP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>accounts</p></td><td><p>M</p></td><td><p>String [8000]</p></td><td><p>Danh sách các tài khoản của chủ tài khoản.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Sau khi giải mã, các trường thông tin sẽ được bao bọc trong một mảng các đối tượng như bên dưới.</p></td></tr><tr><td><p>accounts.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng</p></td></tr><tr><td><p>accounts.accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên tài khoản của khách hàng.</p></td></tr><tr><td><p>accounts.type</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tài khoản (ISO 20022 - Cash Account Type Code)</p><p>Ví dụ:</p><p>TRAN: Tài khoản giao dịch, SVGS: tài khoản tiết kiệm, LOAN: tài khoản vay,</p><p>CARD: tài khản thanh toán bằng thẻ tín dụng…</p></td></tr><tr><td><p>accounts.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD</p></td></tr><tr><td><p>accounts.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP do Ngân hàng nhà nước cung cấp.</p></td></tr><tr><td><p>accounts.status</p></td><td><p>M</p></td><td><p>String [10]</p></td><td><p>Trạng thái của tài khoản</p></td></tr></tbody></table>

#### 4.3.3.2. API lấy chi tiết thông tin tài khoản

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/ais/v1/accounts/information</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>TPP gửi yêu cầu truy vấn chi tiết thông tin tài khoản của chủ tài khoản tới hệ thống OB.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>data</p></td><td><p>M</p></td><td><p>String [3000]</p></td><td><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Mã hóa toàn bộ các tham số bên dưới và bao bọc trong 1 tham số data.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p></td></tr><tr><td><p>accountName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên tài khoản của khách hàng.</p></td></tr><tr><td><p>type</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tài khoản (ISO 20022 - Cash Account Type Code).</p><p>Ví dụ:</p><p>TRAN: Tài khoản giao dịch, SVGS: tài khoản tiết kiệm, LOAN: tài khoản vay, CARD: tài khản thanh toán bằng thẻ tín dụng…</p></td></tr><tr><td><p>currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã 6 số do Ngân hàng nhà nước cung cấp.</p></td></tr><tr><td><p>bankName</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên DP.</p></td></tr><tr><td><p>branchName</p></td><td><p>M</p></td><td><p>String [200]</p></td><td><p>Chi nhánh mở tài khoản.</p></td></tr><tr><td><p>customer</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về Chủ tài khoản.</p></td></tr><tr><td><p>customer.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên chủ tài khoản.</p></td></tr><tr><td><p>customer.phoneNumber</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Số điện thoại.</p></td></tr><tr><td><p>customer.email</p></td><td><p>O</p></td><td><p>String [50]</p></td><td><p>Email liên hệ.</p></td></tr><tr><td><p>customer.citizenId</p></td><td><p>C</p></td><td><p>String [20]</p></td><td><p>Căn cước công dân với khách hàng cá nhân.</p></td></tr><tr><td><p>customer.taxCode</p></td><td><p>C</p></td><td><p>String [13]</p></td><td><p>Mã số thuế đối với khách hàng doanh nghiệp.</p></td></tr><tr><td><p>customer.address</p></td><td><p>O</p></td><td><p>String [255]</p></td><td><p>Địa chỉ của chủ tài khoản.</p></td></tr><tr><td><p>openDate</p></td><td><p>O</p></td><td><p>String [20]</p></td><td><p>Ngày tạo tài khoản.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>lastTransactionDate</p></td><td><p>O</p></td><td><p>String [20]</p></td><td><p>Ngày giao dịch gần nhất.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>status</p></td><td><p>M</p></td><td><p>String [10]</p></td><td><p>Trạng thái của tài khoản</p></td></tr></tbody></table>

#### 4.3.3.3. API tra cứu số dư

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/ais/v1/accounts/balances</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu truy vấn số dư của chủ tài khoản tới hệ thống DP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p>accountName</p></td><td><p>O</p></td><td><p>String [50]</p></td><td><p>Tên tài khoản của khách hàng.</p></td></tr><tr><td><p>type</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tài khoản (ISO 20022 - Cash Account Type Code).</p><p>Ví dụ:</p><p>TRAN: Tài khoản giao dịch, SVGS: tài khoản tiết kiệm, LOAN: tài khoản vay,</p><p>CARD: tài khản thanh toán bằng thẻ tín dụng…</p></td></tr><tr><td><p>availableBalance</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư khả dụng.</p></td></tr><tr><td><p>availableBalance.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư khả dụng.</p></td></tr><tr><td><p>availableBalance.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số dư khả dụng trên tài khoản của khách hàng.</p></td></tr><tr><td><p>availableBalance.amount. currency</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>actualBalance</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư hiện tại.</p></td></tr><tr><td><p>actualBalance.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số dư hiện tại</p></td></tr><tr><td><p>actualBalance.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số dư hiện tại trên tài khoản của khách hàng.</p></td></tr><tr><td><p>actualBalance.amount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>holdBalance</p></td><td><p>O</p></td><td><p>Object</p></td><td><p>Thông tin về số tiền đang được tạm giữ.</p></td></tr><tr><td><p>holdBalance.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Thông tin về số tiền đang được tạm giữ.</p></td></tr><tr><td><p>holdBalance.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số tiền đang tạm giữ trên tài khoản của khách hàng.</p></td></tr><tr><td><p>holdBalance.amount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>creditDebitIndicator</p></td><td><p>O</p></td><td><p>String [4]</p></td><td><p>Theo tiêu chuẩn ISO 20022.</p><p>- CRDT (Credit) Số dư ghi có.</p><p>- DBIT (Debit) Số dư ghi nợ.</p></td></tr></tbody></table>

#### 4.3.3.4. API tra cứu lịch sử giao dịch

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/ais/v1/accounts/transactions</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu tra cứu lịch sử giao dịch của chủ tài khoản tới hệ thống DP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP.</p></td></tr><tr><td><p>accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Thông tin tài khoản của khách hàng, là số tài khoản do DP cấp cho khách hàng.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p>fromDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Thời gian giao dịch từ ngày.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>toDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Thời gian giao dịch đến ngày.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p><p>Khoảng thời gian tối đa là 30 ngày.</p></td></tr><tr><td><p>page</p></td><td><p>O</p></td><td><p>Number</p></td><td><p>Xác định số trang được yêu cầu. Các trang được đánh số từ 1. Nếu tham số không được chỉ định, API sẽ trả về trang đầu tiên (trang số 1).</p></td></tr><tr><td><p>size</p></td><td><p>O</p></td><td><p>Number</p></td><td><p>Xác định số lượng bản ghi trên 1 trang. Nếu tham số không được chỉ định, API sẽ trả về toàn bộ các bản ghi thoả mãn yêu cầu nhưng không quá 50 bản ghi / trang.</p><p>Trong trường hợp tham số được chỉ định, giá trị tối đa cho phép là 50.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản.</p></td></tr><tr><td><p>totalPages</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Tổng số trang.</p></td></tr><tr><td><p>currentPage</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Trang hiện tại.</p></td></tr><tr><td><p>nextPage</p></td><td><p>O</p></td><td><p>Number</p></td><td><p>Trang tiếp theo.</p></td></tr><tr><td><p>pageSize</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số bản ghi trên một trang.</p></td></tr><tr><td><p>totalCount</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Tống số bản ghi trên tất cả các trang.</p></td></tr><tr><td><p>transactions</p></td><td><p>C</p></td><td><p>String [500000]</p></td><td><p>Danh sách dữ liệu về lịch sử giao dịch.</p><p>Bắt buộc khi phát sinh giao dịch phù hợp với điều kiện tìm kiếm.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Sau khi giải mã, các trường thông tin sẽ được bao bọc trong một mảng các đối tượng như bên dưới.</p></td></tr><tr><td><p>transactions.amount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Số tiền giao dịch.</p></td></tr><tr><td><p>transactions.amount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số tiền giao dịch.</p></td></tr><tr><td><p>transactions.amount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>transactions.balances</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Số dư tài khoản.</p></td></tr><tr><td><p>transactions.balances.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số dư ở thời điểm giao dịch.</p></td></tr><tr><td><p>transactions.balances.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD...</p></td></tr><tr><td><p>transactions.creditDebitIndicator</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>- CRDT (Credit) Số dư ghi có.</p><p>- DBIT (Debit) Số dư ghi nợ.</p></td></tr><tr><td><p>transactions.reversalIndicator</p></td><td><p>O</p></td><td><p>boolean</p></td><td><p>Chỉ ra một giao dịch đã bị đảo ngược hoặc huỷ bỏ. Có thể bao gồm các giao dịch bị hoàn tiền, bị huỷ bỏ.</p></td></tr><tr><td><p>transactions.valueDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Thời gian giao dịch.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p>transactions.bankTransactionCode</p></td><td><p>O</p></td><td><p>String [11]</p></td><td><p>Mã giao dịch để phân loại giao dịch khác nhau như thanh toán, rút tiền, nạp tiền, chuyển khoản.</p></td></tr><tr><td><p>transactions.references</p></td><td><p>M</p></td><td><p>String [36]</p></td><td><p>Mã định danh duy nhất cho mỗi giao dịch.</p></td></tr><tr><td><p>transactions.relatedParties</p></td><td><p>M</p></td><td><p>Object</p></td><td></td></tr><tr><td><p>transactions.relatedParties.debtor.name</p></td><td><p>M</p></td><td><p>String [140]</p></td><td><p>Tên của bên (người/công ty/tổ chức) thực hiện chuyển tiền, thanh toán sản phẩm dịch vụ…</p></td></tr><tr><td><p>transactions.relatedParties.debtor.bankCode</p></td><td><p>M</p></td><td><p>String [8]</p></td><td><p>Mã DP của người chuyển tiền</p></td></tr><tr><td><p>transactions.relatedParties.debtor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của người chuyển.</p></td></tr><tr><td><p>transactions.relatedParties.creditor.name</p></td><td><p>M</p></td><td><p>String [140]</p></td><td><p>Tên của bên (người/công ty/ tổ chức) nhận được tiền hoặc thu tiền từ debtor.</p></td></tr><tr><td><p>transactions.relatedParties.creditor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của bên nhận tiền.</p></td></tr><tr><td><p>transactions.relatedParties.creditor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của bên nhận tiền.</p></td></tr><tr><td><p>transactions.additionalTransactionInformation</p></td><td><p>M</p></td><td><p>String [255]</p></td><td><p>Nội dung giao dịch.</p></td></tr></tbody></table>

### 4.3.4. Nhóm API khởi tạo thanh toán

#### 4.3.4.1. API khởi tạo thanh toán

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/pis/v1/payments</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu khởi tạo giao dịch thanh toán tới hệ thống DP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>data</p></td><td><p>M</p></td><td><p>String [5000]</p></td><td><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p><p>Mã hóa toàn bộ các tham số bên dưới và bao bọc trong 1 tham số data.</p></td></tr><tr><td><p>instructionIdentification</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch do TPP khởi tạo.</p><p>Khuyến nghị dùng định dạng: {TPP-ID}-{uuid}-{HHmmss}.</p></td></tr><tr><td><p>debtor</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán dịch vụ sản phầm, thanh toán lương…</p></td></tr><tr><td><p>debtor.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên của bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán sản phẩm dịch vụ, thanh toán lương…</p></td></tr><tr><td><p>debtor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của bên thực hiện thanh toán.</p></td></tr><tr><td><p>debtor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của bên thực hiện thanh toán. Mã 6 số do NHNN cấp cho các tổ chức tín dụng.</p></td></tr><tr><td><p>creditor.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên của bên (người/công ty/tổ chức) nhận được tiền hoặc thu tiền từ debtor.</p></td></tr><tr><td><p>creditor.accountNo</p></td><td><p>M</p></td><td><p>String [34]</p></td><td><p>Số tài khoản của bên nhận tiền.</p></td></tr><tr><td><p>creditor.bankCode</p></td><td><p>M</p></td><td><p>String [6]</p></td><td><p>Mã DP của bên nhận. Mã 6 số do NHNN cấp cho các tổ chức tín dụng.</p></td></tr><tr><td><p>remittanceInformation</p></td><td><p>M</p></td><td><p>String [255]</p></td><td><p>Nội dung giao dịch.</p></td></tr><tr><td><p>instructedAmount</p></td><td><p>M</p></td><td><p>Object</p></td><td><p></p></td></tr><tr><td><p>instructedAmount.value</p></td><td><p>M</p></td><td><p>Number</p></td><td><p>Số tiền giao dịch.</p></td></tr><tr><td><p>instructedAmount.currency</p></td><td><p>M</p></td><td><p>String [3]</p></td><td><p>Loại tiền tệ quy định theo mã của bộ ISO 4212 với 3 ký tự viết hoa.</p><p>Ví dụ: VND, USD…</p></td></tr><tr><td><p>requestedExecutionDate</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày thực hiện giao dịch.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP. Giá trị được DP khởi tạo và trả về cho OB.</p></td></tr><tr><td><p>consentStatus</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Trạng thái ủy quyền:</p><p>+ AWAITING_AUTH: Đã gửi yêu cầu thành công và đang chờ xác nhận.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Mặc định ở phần khởi tạo trạng thái:</p><p>PNDG: Giao dịch đang chờ xử lý</p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

#### 4.3.4.2. API hủy thanh toán giao dịch

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/pis/v1/payments/cancel</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu hủy giao dịch khởi tạo thanh toán tới hệ thống DP (với điều kiện giao dịch chưa được quyết toán).</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>instructionIdentification</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch do TPP khởi tạo.</p><p>Khuyến nghị dùng định dạng: {TPP-ID}-{uuid}-{HHmmss}.</p></td></tr><tr><td><p>debtor</p></td><td><p>M</p></td><td><p>Object</p></td><td><p>Bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán dịch vụ sản phầm, thanh toán lương…</p></td></tr><tr><td><p>debtor.name</p></td><td><p>M</p></td><td><p>String [50]</p></td><td><p>Tên của bên (người/công ty/tổ chức) nợ, vay tiền, thực hiện chuyển tiền, thanh toán sản phẩm dịch vụ, thanh toán lương…</p></td></tr><tr><td><p>debtor.accountNo</p></td><td><p>M</p></td><td><p>String [2000]</p></td><td><p>Số tài khoản của bên thực hiện thanh toán.</p><p>Dữ liệu nhạy cảm cần được mã hóa, tham khảo thêm tại mục 2.2.2. Phương pháp mã hóa và giải mã dữ liệu.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

#### 4.3.4.3. API xác nhận thanh toán / hủy thanh toán

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/pis/v1/payments/submit</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>POST</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu xác nhận thanh toán / hủy thanh toán tới hệ thống DP (với điều kiện API khởi tạo thanh toán đã thành công).</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Body Request</strong></p></td></tr><tr><td><p>dpTransactionId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã định danh duy nhất cho phiên chấp thuận trên hệ thống của DP. Giá trị được DP khởi tạo và trả về cho OB.</p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>paymentId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: P{TPP-ID}HHmmss-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

#### 4.3.4.4. API truy vấn trạng thái thanh toán

<table><tbody><tr><td><p>Endpoint</p></td><td><p>{dp_domain}/ob/pis/v1/payments/status/{orderId}</p></td></tr><tr><td><p>HTTP Method</p></td><td><p>GET</p></td></tr><tr><td><p>Mô tả</p></td><td><p>OB gửi yêu cầu truy vấn trạng thái thanh toán tới hệ thống DP.</p></td></tr></tbody></table>

**Danh sách các tham số trong Header:** Tham khảo tại mục 4.1. Định dạng chung của Header.

**Danh sách các tham số trong Body:**

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p><strong>Path variable</strong></p></td></tr><tr><td><p>orderId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: {Provider-ID}-{TPP-ID}-{uuid}.</p></td></tr><tr><td><p><strong>Body Response</strong></p><p>Trường hợp thành công: Hệ thống DP sẽ trả về HTTP Status Code 200 - OK kèm danh sách tham số bên dưới.</p><p>Trong trường hợp có lỗi xảy ra, vui lòng tham chiếu tại mục 5.5. Bảng mã lỗi API khởi tạo thanh toán.</p></td></tr><tr><td><p>paymentId</p></td><td><p>M</p></td><td><p>String [57]</p></td><td><p>Mã giao dịch duy nhất cho dịch vụ thanh toán, DP cấp cho TPP thông qua OB.</p><p>Khuyến nghị dùng định dạng: P{TPP-ID}HHmmss-{uuid}.</p></td></tr><tr><td><p>paymentStatus</p></td><td><p>M</p></td><td><p>String [4]</p></td><td><p>Mã trạng thái của giao dịch theo tiêu chuẩn của ISO 20022. Tham khảo thêm tại mục 5.6 – Bảng mã trạng thái của giao dịch.</p></td></tr><tr><td><p>statusDateTime</p></td><td><p>M</p></td><td><p>String [20]</p></td><td><p>Ngày và giờ tại thời điểm cập nhật trạng thái khởi tạo thanh toán.</p><p>Định dạng: yyyy-MM-ddTHH:mm:ssZ.</p></td></tr></tbody></table>

# 5. Bảng mã lỗi

Hệ thống sẽ trả về HTTP Status Code tương ứng kèm danh sách các tham số:

<table><tbody><tr><td><p><strong>Tham số</strong></p></td><td><p><strong>Bắt buộc</strong></p></td><td><p><strong>Loại dữ liệu</strong></p></td><td><p><strong>Mô tả</strong></p></td></tr><tr><td><p>error</p></td><td><p>M</p></td><td><p>String [30]</p></td><td><p>Mã lỗi do hệ thống trả về, danh sách mã lỗi được liệt kê ở bảng mã lỗi bên dưới.</p></td></tr><tr><td><p>error_description</p></td><td><p>O</p></td><td><p>String [200]</p></td><td><p>Cung cấp thông tin lỗi bổ sung.</p></td></tr><tr><td><p>error_uri</p></td><td><p>O</p></td><td><p>String [2000]</p></td><td><p>URI xác định trang web có thông tin bổ sung về lỗi, giúp con người có thể đọc được.</p></td></tr></tbody></table>

## 5.1. Bảng mã lỗi API lấy mã truy cập

<table><tbody><tr><td><p><strong>HTTP Status Code</strong></p></td><td><p><strong>error</strong></p></td><td><p><strong>error_description</strong></p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>The request is malformed or missing required parameters&nbsp;</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing required header parameter: {param}&nbsp;</p></td></tr><tr><td><p>400</p></td><td><p>invalid_client&nbsp;</p></td><td><p>The client authentication failed or the client is unknown</p></td></tr><tr><td><p>400</p></td><td><p>invalid_scope&nbsp;</p></td><td><p>The requested scope is invalid or not permitted for this access token</p></td></tr><tr><td><p>403</p></td><td><p>account_inactive</p></td><td><p>Your account has been deactivated or suspended. Please contact customer support for further assistance</p></td></tr><tr><td><p>403</p></td><td><p>account_over_rate_limit</p></td><td><p>Your account has exceeded the allowed request rate limit. Please slow down your requests or contact support for assistance</p></td></tr><tr><td><p>403</p></td><td><p>account_over_qps_limit</p></td><td><p>Your account has exceeded the allowed queries per second (QPS) limit. Please reduce request frequency or contact support</p></td></tr><tr><td><p>403</p></td><td><p>rate_limit_exceeded</p></td><td><p>The allowed rate limit has been exceeded. Please wait and try again later or contact support for further information</p></td></tr><tr><td><p>500</p></td><td><p>internal_error</p></td><td><p>An unexpected error occurred</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to open banking service. Please try again later or contact support</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to data provider &lt;bank code&gt; service. Please try again later or contact support</p></td></tr></tbody></table>

## 5.2. Bảng mã lỗi API lấy danh sách DP

<table><tbody><tr><td><p><strong>HTTP Status Code</strong></p></td><td><p><strong>error</strong></p></td><td><p><strong>error_description</strong></p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>The request is malformed or missing required parameters&nbsp;</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing required header parameter: {param}</p></td></tr><tr><td><p>401</p></td><td><p>unauthorized</p></td><td><p>Authentication failed or the access token is missing</p></td></tr><tr><td><p>403</p></td><td><p>insufficient_scope&nbsp;</p></td><td><p>The access token does not have sufficient scope to access the requested resource</p></td></tr><tr><td><p>500</p></td><td><p>internal_error</p></td><td><p>An unexpected error occurred</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to open banking service. Please try again later or contact support</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to data provider &lt;bank code&gt; service. Please try again later or contact support</p></td></tr></tbody></table>

## 5.3. Bảng mã lỗi API yêu cầu xác thực và chấp thuận

<table><tbody><tr><td><p><strong>HTTP Status Code</strong></p></td><td><p><strong>error</strong></p></td><td><p><strong>error_description</strong></p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>The request is malformed or missing required parameters&nbsp;</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing required header parameter: {param}</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing JWS-Signature header. Please ensure the header is present and the signature matches the request body</p></td></tr><tr><td><p>400</p></td><td><p>invalid_permissions</p></td><td><p>The request is malformed or missing necessary permissions</p></td></tr><tr><td><p>400</p></td><td><p>invalid_psu</p></td><td><p>The specified psu is invalid or could not be decrypted</p></td></tr><tr><td><p>400</p></td><td><p>invalid_period</p></td><td><p>The specified period is not allowed</p></td></tr><tr><td><p>400</p></td><td><p>not_found_psu</p></td><td><p>The specified psu could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_dp</p></td><td><p>The specified dp could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_dpTransactionId</p></td><td><p>The specified dpTransactionId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_consentId</p></td><td><p>The specified consentId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_obTransactionId</p></td><td><p>The specified obTransactionId could not be found</p></td></tr><tr><td><p>401</p></td><td><p>unauthorized&nbsp;</p></td><td><p>Authentication failed or the access token is missing</p></td></tr><tr><td><p>401</p></td><td><p>invalid_consentId</p></td><td><p>The specified consentId is expired, revoked, or invalid</p></td></tr><tr><td><p>401</p></td><td><p>invalid_dpTransactionId</p></td><td><p>The specified dpTransactionId is expired, revoked, or invalid</p></td></tr><tr><td><p>403</p></td><td><p>insufficient_scope&nbsp;</p></td><td><p>The access token does not have sufficient scope to access the requested resource</p></td></tr><tr><td><p>500</p></td><td><p>internal_error</p></td><td><p>An unexpected error occurred</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to open banking service. Please try again later or contact support</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to data provider &lt;bank code&gt; service. Please try again later or contact support</p></td></tr></tbody></table>

## 5.4. Bảng mã lỗi API truy vấn thông tin tài khoản


<table><tbody><tr><td><p><strong>HTTP Status Code</strong></p></td><td><p><strong>error</strong></p></td><td><p><strong>error_description</strong></p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>The request is malformed or missing required parameters&nbsp;</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing required header parameter: {param}</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing JWS-Signature header. Please ensure the header is present and the signature matches the request body</p></td></tr><tr><td><p>400</p></td><td><p>not_found_account</p></td><td><p>The specified account could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_dp</p></td><td><p>The specified dp could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_dpTransactionId</p></td><td><p>The specified dpTransactionId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_consentId</p></td><td><p>The specified consentId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_obTransactionId</p></td><td><p>The specified obTransactionId could not be found</p></td></tr><tr><td><p>401</p></td><td><p>unauthorized&nbsp;</p></td><td><p>Authentication failed or the access token is missing</p></td></tr><tr><td><p>401</p></td><td><p>invalid_consentId</p></td><td><p>The specified consentId is expired, revoked, or invalid</p></td></tr><tr><td><p>401</p></td><td><p>invalid_dpTransactionId</p></td><td><p>The specified dpTransactionId is expired, revoked, or invalid</p></td></tr><tr><td><p>403</p></td><td><p>insufficient_scope&nbsp;</p></td><td><p>The access token does not have sufficient scope to access the requested resource</p></td></tr><tr><td><p>500</p></td><td><p>internal_error</p></td><td><p>An unexpected error occurred</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to open banking service. Please try again later or contact support</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to data provider &lt;bank code&gt; service. Please try again later or contact support</p></td></tr></tbody></table>

## 5.5. Bảng mã lỗi API khởi tạo thanh toán

<table><tbody><tr><td><p><strong>HTTP Status Code</strong></p></td><td><p><strong>error</strong></p></td><td><p><strong>error_description</strong></p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>The request is malformed or missing required parameters&nbsp;</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing required header parameter: {param}</p></td></tr><tr><td><p>400</p></td><td><p>invalid_request</p></td><td><p>Invalid or missing JWS-Signature header. Please ensure the header is present and the signature matches the request body</p></td></tr><tr><td><p>400</p></td><td><p>invalid_instruction_identification</p></td><td><p>The identification is duplicated</p></td></tr><tr><td><p>400</p></td><td><p>invalid_transaction_status</p></td><td><p>The transaction status is invalid</p></td></tr><tr><td><p>400</p></td><td><p>not_found_account</p></td><td><p>The specified account could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_dp</p></td><td><p>The specified dp could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_dpTransactionId</p></td><td><p>The specified dpTransactionId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_consentId</p></td><td><p>The specified consentId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_obTransactionId</p></td><td><p>The specified obTransactionId could not be found</p></td></tr><tr><td><p>400</p></td><td><p>not_found_transaction</p></td><td><p>The transaction is not found</p></td></tr><tr><td><p>401</p></td><td><p>unauthorized&nbsp;</p></td><td><p>Authentication failed or the access token is missing</p></td></tr><tr><td><p>401</p></td><td><p>invalid_consentId</p></td><td><p>The specified consentId is expired, revoked, or invalid</p></td></tr><tr><td><p>401</p></td><td><p>invalid_dpTransactionId</p></td><td><p>The specified dpTransactionId is expired, revoked, or invalid</p></td></tr><tr><td><p>403</p></td><td><p>insufficient_scope&nbsp;</p></td><td><p>The access token does not have sufficient scope to access the requested resource</p></td></tr><tr><td><p>500</p></td><td><p>internal_error</p></td><td><p>An unexpected error occurred</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to open banking service. Please try again later or contact support</p></td></tr><tr><td><p>503</p></td><td><p>service_unavailable</p></td><td><p>Unable to connect to data provider &lt;bank code&gt; service. Please try again later or contact support</p></td></tr></tbody></table>

## 5.6. Bảng mã trạng thái của giao dịch

<table><tbody><tr><td><p><strong>paymentStatus</strong></p></td><td><p><strong>description</strong></p></td><td><p><strong>description (vietnamese)</strong></p></td></tr><tr><td><p>PDNG</p></td><td><p>Pending&nbsp;</p></td><td><p>Giao dịch đang chờ xử lý</p></td></tr><tr><td><p>ACSP</p></td><td><p>Accepted Settlement in Progress</p></td><td><p>Giao dịch đang trong quá trình xử lý thanh toán</p></td></tr><tr><td><p>ACSC</p></td><td><p>Accepted Settlement Completed</p></td><td><p>Giao dịch đã hoàn tất xử lý thanh toán</p></td></tr><tr><td><p>RJCT</p></td><td><p>Rejected</p></td><td><p>Giao dịch bị từ chối</p></td></tr><tr><td><p>CANC</p></td><td><p>Cancelled</p></td><td><p>Giao dịch đã bị hủy</p></td></tr><tr><td><p>EXPR</p></td><td><p>Expired</p></td><td><p>Giao dịch đã hết hạn</p></td></tr></tbody></table>
